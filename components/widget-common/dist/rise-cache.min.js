var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.RiseCache=function(){"use strict";function e(e){var n=new XMLHttpRequest,t=this;e&&"function"==typeof e&&(l?n.open("GET",u,!0):n.open("GET",u+"ping?callback=_",!0),n.onreadystatechange=function(){try{if(4===n.readyState)if(c=!0,200===n.status){f=!0;try{var i=n.responseText?JSON.parse(n.responseText):"";i&&(d=i.version)}catch(r){console.log(r)}e(!0,n.responseText)}else{if(404===n.status)return l=!0,u="https://localhost:9495/",t.ping(e);if(g)return l=!0,g=!1,u="http://localhost:9494/",t.ping(e);console.debug("Rise Cache is not running"),l=!1,f=!1,e(!1,null)}}catch(r){console.debug("Caught exception: ",r.description)}},n.send())}function n(e,n,t){function i(){var n,i,s;f?n=l?r(d,p)>0?u+"files?url="+e:u+"files?url="+encodeURIComponent(e):t?u+"?url="+encodeURIComponent(e):u+"cb="+(new Date).getTime()+"?url="+encodeURIComponent(e):t?n=e:(i=e.split("?"),s=1===i.length?"?":"&",n=e+s+"cb="+(new Date).getTime()),o("HEAD",n)}function r(e,n){function t(e){return/^\d+$/.test(e)}function i(e){for(s=0;s<e.length;s++)if(!t(e[s]))return!1;return!0}var r=e.split("."),o=n.split("."),s=0;if(!i(r)||!i(o))return 0/0;for(s=0;s<r.length;++s){if(o.length===s)return 1;if(r[s]!==o[s])return r[s]>o[s]?1:-1}return r.length!==o.length?-1:0}function o(e,t){var i=new XMLHttpRequest,r={xhr:i,url:t};f?(i.open(e,t,!0),i.addEventListener("loadend",function(){var a=i.status||0;202===a?(s++,3>s?setTimeout(function(){o(e,t)},3e3):n(r,new Error("File is downloading"))):a>=200&&300>a?n(r):"HEAD"===e?o("GET",t):n(r,new Error("The request failed with status code: "+a))}),i.send()):n(r)}if(e&&n&&"function"==typeof n){var s=0;return c?i():this.ping(i)}}function t(e){var n="";switch(e){case 502:n="There was a problem retrieving the file.";break;case 504:n="Unable to download the file. The server is not responding.";break;case 507:n="There is not enough disk space to save the file on Rise Cache.";break;case 534:n="The file does not exist or cannot be accessed.";break;default:n=""}return n}function i(e){return e&&"function"==typeof e?c?(e(f),void 0):this.ping(function(){e(f)}):void 0}function r(e){return e&&"function"==typeof e?c?(e(l),void 0):this.ping(function(){e(l)}):void 0}function o(e){return e&&"function"==typeof e?this.isV2Running(function(n){n?e(n):e(s())}):void 0}function s(){var e=h.getDateObjectFromPlayerVersionString("2016.10.10.00.00"),n=h.getQueryParameter("sysInfo");if(!n){var t=h.getQueryParameter("parent");n=h.getQueryStringParameter("sysInfo",t)}if(n){var i=h.getQueryStringParameter("pv",n),r=h.getDateObjectFromPlayerVersionString(i);return r>=e}return!1}function a(){c=!1,f=!1,l=!1,g=!0,u="http://localhost:9494/"}var u="http://localhost:9494/",c=!1,f=!1,l=!1,g=!0,h=RiseVision.Common.Utilities,p="1.7.3",d="";return{getErrorMessage:t,getFile:n,isRiseCacheRunning:i,isV2Running:r,isRCV2Player:o,ping:e,reset:a}}();