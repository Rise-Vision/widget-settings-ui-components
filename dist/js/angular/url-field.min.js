!function(){"use strict";angular.module("risevision.widget.common.url-field",["risevision.common.i18n","risevision.widget.common.tooltip"]).directive("urlField",["$templateCache","$log","$http",function(e,i,l){return{restrict:"E",require:"?ngModel",scope:{url:"=",hideLabel:"@",fileType:"@"},template:e.get("_angular/url-field/url-field.html"),link:function(e,n,t,a){function d(e){return!(!e||!e.startsWith("https://"))}function r(e,i){var l,n=e.toLowerCase();switch(i){case"image":l=[".jpg",".jpeg",".png",".bmp",".svg",".gif",".webp"];break;case"video":l=[".webm",".mp4",".ogv",".ogg"];break;default:l=[]}for(var t=0,a=l.length;a>t;t++)if(-1!==n.indexOf(l[t]))return!0;return!1}function o(){if("undefined"!==e.fileType&&"undefined"!==e.url&&"image"===e.fileType){var i=new Image;i.onload=function(){e.valid=!0,e.testingFile=!1,e.$apply()},i.onerror=function(){e.valid=!1,e.testingFile=!1,e.invalidType="load-fail",e.$apply()},e.testingFile=!0,i.src=e.url}}function u(){e.testingFile=!0,l({method:"HEAD",url:"https://proxy.risevision.com/"+e.url}).then(function(){e.valid=!0,e.testingFile=!1},function(){e.valid=!1,e.testingFile=!1,e.invalidType="load-fail"})}function s(i){var l,n;return l=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[\/?#]\S*)?$/i,-1===i.indexOf("://")&&(i="https://"+i),n=l.test(i),n&&"undefined"!=typeof e.fileType?(n=r(i,e.fileType),n||(e.invalidType=e.fileType)):e.invalidType="url",n&&(d(i)?"image"===e.fileType?o():"video"===e.fileType&&u():(n=!1,e.invalidType="insecure")),n}e.doValidation=!0,e.forcedValid=!1,e.valid=!0,e.testingFile=!1,e.invalidType="url",e.allowInitEmpty="undefined"!=typeof t.initEmpty,e.blur=function(){e.$emit("urlFieldBlur")},e.$watch("url",function(i){"undefined"!=typeof i&&null!==i&&(""!==i&&e.allowInitEmpty&&(e.allowInitEmpty=!1),e.doValidation&&!e.allowInitEmpty&&(e.valid=s(e.url)))}),e.$watch("valid",function(e){a&&(i.info("Calling $setValidity() on parent controller"),a.$setValidity("valid",e))}),e.$watch("doValidation",function(i){"undefined"!=typeof e.url&&(i?(e.forcedValid=!1,e.allowInitEmpty||(e.valid=s(e.url))):(e.forcedValid=!0,e.valid=!0))})}}}])}(),function(e){try{e=angular.module("risevision.widget.common.url-field")}catch(i){e=angular.module("risevision.widget.common.url-field",[])}e.run(["$templateCache",function(e){"use strict";e.put("_angular/url-field/url-field.html",'<div class="form-group" >\n  <label ng-if="!hideLabel">{{ "url.label" | translate }}</label>\n  <div>\n    <input name="url" type="text" ng-model="url" ng-blur="blur()" ng-disabled="testingFile" class="form-control" placeholder="https://">\n  </div>\n  <p ng-if="!valid && invalidType === \'url\'" class="text-danger">{{ "url.errors.url" | translate }}</p>\n  <p ng-if="!valid && invalidType === \'image\'" class="text-danger">{{ "url.errors.image" | translate }}</p>\n  <p ng-if="!valid && invalidType === \'video\'" class="text-danger">{{ "url.errors.video" | translate }}</p>\n  <p ng-if="!valid && invalidType === \'insecure\'" class="text-danger">We can\'t show this content because the URL is insecure. Make sure the URL begins with "HTTPS". If you need assistance, please email <a target="_blank" href="mailto:support@risevision.com">support@risevision.com</a>.</p>\n  <p ng-if="!valid && invalidType === \'load-fail\'" class="text-danger">The file could not be found using the URL provided. Please enter a different one. If you need help email <a href="mailto:support@risevision.com">support@risevision.com</a>.</p>\n  <div class="checkbox" ng-show="forcedValid || !valid">\n    <label>\n      <input name="validate-url" ng-click="doValidation = !doValidation" type="checkbox"\n             value="validate-url"> {{"url.validate.label" | translate}}\n    </label>\n  </div>\n</div>\n')}])}();