!function(){"use strict";angular.module("risevision.widget.common.url-field",["risevision.common.i18n","risevision.widget.common.tooltip"]).directive("urlField",["$templateCache","$log",function(l,e){return{restrict:"E",require:"?ngModel",scope:{url:"=",hideLabel:"@",fileType:"@"},template:l.get("_angular/url-field/url-field.html"),link:function(l,i,n,a){function t(l,e){var i,n=l.toLowerCase();switch(e){case"image":i=[".jpg",".jpeg",".png",".bmp",".svg",".gif"];break;case"video":i=[".webm",".mp4",".ogv",".ogg"];break;default:i=[]}for(var a=0,t=i.length;t>a;a++)if(-1!==n.indexOf(i[a]))return!0;return!1}function d(){if("undefined"!==l.fileType&&"undefined"!==l.url&&"image"===l.fileType){var e=new Image;e.onload=function(){l.valid=!0,l.$apply()},e.onerror=function(){l.valid=!1,l.invalidType=l.fileType,l.$apply()},e.src=l.url}}function r(e){var i,n;return i=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/i,-1===e.indexOf("://")&&(e="http://"+e),n=i.test(e),n&&"undefined"!=typeof l.fileType?(n=t(e,l.fileType),n||(l.invalidType=l.fileType)):l.invalidType="url",n&&d(),n}l.doValidation=!0,l.forcedValid=!1,l.valid=!0,l.invalidType="url",l.allowInitEmpty="undefined"!=typeof n.initEmpty,l.blur=function(){l.$emit("urlFieldBlur")},l.$watch("url",function(e){"undefined"!=typeof e&&null!==e&&(""!==e&&l.allowInitEmpty&&(l.allowInitEmpty=!1),l.doValidation&&!l.allowInitEmpty&&(l.valid=r(l.url)))}),l.$watch("valid",function(l){a&&(e.info("Calling $setValidity() on parent controller"),a.$setValidity("valid",l))}),l.$watch("doValidation",function(e){"undefined"!=typeof l.url&&(e?(l.forcedValid=!1,l.allowInitEmpty||(l.valid=r(l.url))):(l.forcedValid=!0,l.valid=!0))})}}}])}(),function(l){try{l=angular.module("risevision.widget.common.url-field")}catch(e){l=angular.module("risevision.widget.common.url-field",[])}l.run(["$templateCache",function(l){"use strict";l.put("_angular/url-field/url-field.html",'<div class="form-group" >\n  <label ng-if="!hideLabel">{{ "url.label" | translate }}</label>\n  <div>\n    <input name="url" type="text" ng-model="url" ng-blur="blur()" class="form-control" placeholder="http://">\n  </div>\n  <p ng-if="!valid && invalidType === \'url\'" class="text-danger">{{ "url.errors.url" | translate }}</p>\n  <p ng-if="!valid && invalidType === \'image\'" class="text-danger">{{ "url.errors.image" | translate }}</p>\n  <p ng-if="!valid && invalidType === \'video\'" class="text-danger">{{ "url.errors.video" | translate }}</p>\n  <div class="checkbox" ng-show="forcedValid || !valid">\n    <label>\n      <input name="validate-url" ng-click="doValidation = !doValidation" type="checkbox"\n             value="validate-url"> {{"url.validate.label" | translate}}\n    </label>\n  </div>\n</div>\n')}])}();