!function(){"use strict";angular.module("risevision.widget.common.font-setting",["angularLoad","ui.tinymce"]).directive("fontSetting",["$templateCache","$log","googleFontLoader",function(e,t,n){return{restrict:"AE",scope:{fontData:"=",previewText:"@"},template:e.get("_angular/font-setting/font-setting.html"),transclude:!1,link:function(e){function t(t){e.tinymceOptions={font_formats:WIDGET_SETTINGS_UI_CONFIG.families+t,fontsize_formats:WIDGET_SETTINGS_UI_CONFIG.sizes,menubar:!1,plugins:"textcolor colorpicker",skin_url:"//s3.amazonaws.com/rise-common/styles/tinymce/rise",statusbar:!1,toolbar:"fontselect fontsizeselect | alignleft aligncenter alignright alignjustify | forecolor backcolor | bold italic underline",setup:function(e){e.on("init",function(){a(e)}),e.on("ExecCommand",function(e){i(e)})},init_instance_callback:function(e){var t=e.formatter.apply;e.formatter.apply=function(n,a,o){var i={command:n,value:a.value};t(n,a,o),e.fire("ExecCommand",i)}}}}function a(e){if(c){switch(c.align){case"left":e.execCommand("JustifyLeft",!1);break;case"center":e.execCommand("JustifyCenter",!1);break;case"right":e.execCommand("JustifyRight",!1);break;case"justify":e.execCommand("JustifyFull",!1)}$(".mce-colorbutton[aria-label='Text color'] span").css("background-color",c.forecolor),$(".mce-colorbutton[aria-label='Background color'] span").css("background-color",c.backcolor),c.bold&&l($(".mce-btn[aria-label='Bold']")),c.italic&&l($(".mce-btn[aria-label='Italic']")),c.underline&&l($(".mce-btn[aria-label='Underline']")),e.execCommand("FontName",!1,c.font.family),e.execCommand("FontSize",!1,c.size)}}function o(e){return-1!==WIDGET_SETTINGS_UI_CONFIG.families.indexOf(e)?"standard":-1!==s.indexOf(e)?"google":""}function i(e){switch(e.command){case"FontName":c.font.family=e.value,c.font.type=o(e.value);break;case"FontSize":c.size=e.value;break;case"JustifyLeft":c.align="left";break;case"JustifyCenter":c.align="center";break;case"JustifyRight":c.align="right";break;case"JustifyFull":c.align="justify";break;case"forecolor":c.forecolor=e.value;break;case"hilitecolor":c.backcolor=e.value;break;case"mceToggleFormat":"bold"===e.value?(c.bold=!c.bold,l($(".mce-btn[aria-label='Bold']"))):"italic"===e.value?(c.italic=!c.italic,l($(".mce-btn[aria-label='Italic']"))):"underline"===e.value&&(c.underline=!c.underline,l($(".mce-btn[aria-label='Underline']")))}r(c)}function l(e){e.toggleClass("mce-active")}function r(t){var n=document.querySelector(".text-container"),a=document.querySelector(".text");e.previewText&&t&&(a.style.fontFamily=t.font.family,a.style.fontSize=t.size,a.style.fontWeight=t.bold?"bold":"normal",a.style.fontStyle=t.italic?"italic":"normal",a.style.textDecoration=t.underline?"underline":"none",a.style.color=t.forecolor,a.style.backgroundColor=t.backcolor,n.style.textAlign=t.align)}var c=null,s="";e.defaultFont={font:{family:"verdana,geneva,sans-serif",type:"standard"},size:"24px",align:"left",bold:!1,italic:!1,underline:!1,forecolor:"black",backcolor:"transparent"},n.getFonts().then(function(e){s=e,t(e)}),e.defaults=function(e){if(e)for(var t=1,n=arguments.length;n>t;t++){var a=arguments[t];for(var o in a)void 0===e[o]&&(e[o]=a[o])}return e};var f=e.$watch("fontData",function(t){t&&(e.defaults(t,e.defaultFont),r(t),f(),e.previewText&&e.$watch("fontData",r,!0),c=t)})}}}])}(),function(){"use strict";angular.module("risevision.widget.common.font-setting").factory("googleFontLoader",["$http","angularLoad",function(e,t){var n="https://www.googleapis.com/webfonts/v1/webfonts?key=AIzaSyBXxVK_IOV7LNQMuVVo_l7ZvN53ejN86zY",a="//fonts.googleapis.com/css?family=",o=["Buda","Coda Caption","Open Sans Condensed","UnifrakturCook","Molle"],i=",sans-serif;",l="",r={};return r.getFonts=function(){return e.get(n,{cache:!0}).then(function(e){var n="";if(e.data&&e.data.items)for(var r=0;r<e.data.items.length;r++)n=e.data.items[r].family,-1===o.indexOf(n)&&(t.loadCSS(a+n).then(function(){}),l+=n+"="+n+i);return l})},r}])}(),function(e){try{e=angular.module("risevision.widget.common.font-setting")}catch(t){e=angular.module("risevision.widget.common.font-setting",[])}e.run(["$templateCache",function(e){"use strict";e.put("_angular/font-setting/font-setting.html",'<div class="font-setting">\n  <div class="row">\n    <div class="col-md-12">\n      <textarea ui-tinymce="tinymceOptions" ng-model="tinymceModel" ng-if="tinymceOptions"></textarea>\n    </div>\n  </div>\n  <div class="row" ng-if="previewText">\n    <div class="col-md-12">\n      <div class="text-container form-group">\n        <span class="text">{{previewText}}</span>\n      </div>\n    </div>\n  </div>\n</div>\n')}])}();